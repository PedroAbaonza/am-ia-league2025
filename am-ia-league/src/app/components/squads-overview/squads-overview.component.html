<section class="squads-overview">
  <div class="container">
    <div class="section-header">
      <h2 class="section-title gradient-text">Estructura de Squads</h2>
    </div>

    <!-- Stats Generales -->
    <div class="squad-stats">
      <div class="stat-circle glow-blue">
        <div class="stat-number font-mono">6</div>
        <div class="stat-label">Squads Totales</div>
      </div>
      <div class="stat-circle glow-pink">
        <div class="stat-number font-mono">5</div>
        <div class="stat-label">Desarrolladores por Squad</div>
      </div>
      <div class="stat-circle glow-gradient">
        <div class="stat-number font-mono">1</div>
        <div class="stat-label">Scrum Master</div>
      </div>
    </div>

    <!-- Button to toggle squads visibility -->
    <div class="cta-section">
      <button class="cta-btn primary" (click)="toggleSquadsDetails()">
        {{ showSquadsDetails ? "Ocultar Equipos" : "Ver Equipos Aeroméxico" }}
      </button>
    </div>

    <!-- Grid de Squads cuando está visible -->
    <div class="squads-grid" *ngIf="showSquadsDetails">
      <div
        class="squad-card"
        *ngFor="let squad of squads; let i = index"
        [style.border-color]="squad.color"
        [class.glow-blue]="squad.color === '#00AEEF'"
        [class.glow-pink]="squad.color === '#FF2D82'"
      >
        <div class="squad-header">
          <h3 class="squad-name">{{ squad.name }}</h3>
          <div class="squad-points font-mono" [style.color]="squad.color">
            {{ squad.totalPoints.toLocaleString() }}pts
          </div>
        </div>

        <div class="squad-position">
          <span
            class="position-badge"
            [class]="'position-' + (i + 1)"
            [style.background]="getPositionColor(i + 1)"
          >
            #{{ i + 1 }}
          </span>
        </div>

        <div class="scrum-master">
          <div class="role-label">Scrum Master</div>
          <div class="member-name">{{ squad.scrumMaster }}</div>
        </div>

        <div class="developers">
          <div class="role-label">Desarrolladores</div>
          <div class="developers-list">
            <div class="developer-item" *ngFor="let dev of squad.developers">
              <div class="developer-avatar" [style.background]="squad.color">
                {{ getInitials(dev) }}
              </div>
              <span class="developer-name">{{ dev }}</span>
            </div>
          </div>
        </div>

        <div class="squad-progress">
          <div class="progress-bar">
            <div
              class="progress-fill"
              [style.width]="getProgressPercentage(squad.totalPoints) + '%'"
              [style.background]="squad.color"
            ></div>
          </div>
          <div class="progress-text">
            {{ getProgressPercentage(squad.totalPoints) }}% del objetivo
          </div>
        </div>
      </div>
    </div>

    <!-- Progreso por Ruta y Retos Especiales -->
    <div class="progress-challenges-section" *ngIf="showSquadsDetails">
      <div class="progress-challenges-grid">
        <!-- Progreso por Ruta -->
        <div class="progress-routes-card">
          <div class="card-header">
            <div class="header-icon progress-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"
                />
              </svg>
            </div>
            <h3 class="card-title">Progreso por Ruta</h3>
          </div>

          <div class="routes-list">
            <div
              class="route-item completed"
              *ngFor="let route of completedRoutes"
            >
              <div class="route-info">
                <div class="route-name">{{ route.name }}</div>
                <div class="route-progress">
                  Promedio: {{ route.averagePoints }} pts
                </div>
              </div>
              <div class="route-status completed-status">Completada</div>
            </div>

            <div
              class="route-item in-progress"
              *ngFor="let route of inProgressRoutes"
            >
              <div class="route-info">
                <div class="route-name">{{ route.name }}</div>
                <div class="route-progress">
                  Promedio: {{ route.averagePoints }} pts
                </div>
              </div>
              <div class="route-status progress-status">En progreso</div>
            </div>

            <div class="route-item pending" *ngFor="let route of pendingRoutes">
              <div class="route-info">
                <div class="route-name">{{ route.name }}</div>
                <div class="route-progress">
                  Promedio: {{ route.averagePoints }} pts
                </div>
              </div>
              <div class="route-status pending-status">Pendiente</div>
            </div>
          </div>
        </div>

        <!-- Retos Especiales -->
        <div class="special-challenges-card">
          <div class="card-header">
            <div class="header-icon challenge-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                />
              </svg>
            </div>
            <h3 class="card-title">Retos Especiales</h3>
          </div>

          <div class="challenges-stats">
            <div class="challenge-stat">
              <div class="stat-number-large">{{ totalDocumentations }}</div>
              <div class="stat-description">Documentaciones</div>
            </div>
            <div class="challenge-stat">
              <div class="stat-number-large">{{ totalDemos }}</div>
              <div class="stat-description">Demos Liderados</div>
            </div>
          </div>

          <div class="challenges-list">
            <div
              class="challenge-item"
              *ngFor="let challenge of specialChallenges"
            >
              <div class="challenge-info">
                <div class="challenge-name">{{ challenge.name }}</div>
                <div class="challenge-points">+{{ challenge.points }} pts</div>
              </div>
              <div
                class="challenge-status"
                [class]="
                  challenge.status === 'Aceptado'
                    ? 'accepted-status'
                    : 'pending-challenge-status'
                "
              >
                {{ challenge.status }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
